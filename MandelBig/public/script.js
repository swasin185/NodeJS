"use strict";exports.__esModule=!0;for(var big_js_1=require("big.js"),Complex_js_1=require("./Complex.js"),canvas=document.getElementById("cpxCanvas"),ctx=canvas.getContext("2d"),boxReal=document.getElementById("realValue"),boxImage=document.getElementById("imageValue"),boxBoundary=document.getElementById("boundary"),txtRunTime=document.getElementById("runTime"),WIDTH=canvas.width,HEIGHT=canvas.height,MID_WIDTH=canvas.width/2,MID_HEIGHT=canvas.height/2,MAX_N=51,PALETTE=new Array(MAX_N),level=0,x=Math.floor(3*Math.random()),i=0;i<MAX_N;i++)PALETTE[i]=new Array(3),PALETTE[i][x+i%3]=level=5*i,PALETTE[i][(x+i+1)%3]=Math.floor(Math.random()*level/2+level/2),PALETTE[i][(x+i+2)%3]=Math.floor(Math.random()*level/2+level/2);var boundary,center_real,center_image,center,imgData=ctx.createImageData(WIDTH,HEIGHT),data=imgData.data;function calculate(){console.log("calculate");for(var e,a,t,o,n=(new Date).getTime(),l=(boundary=new big_js_1.default(boxBoundary.value),center_real=new big_js_1.default(boxReal.value),center_image=new big_js_1.default(boxImage.value),center=new Complex_js_1.Complex(center_real,center_image),new Complex_js_1.Complex(new big_js_1.default(-.5),new big_js_1.default(-.5)),0),r=Math.round(WIDTH*HEIGHT/100),i=0,T=0;T<HEIGHT;T++)for(var c=boundary.times(T-MID_HEIGHT).div(HEIGHT).add(center_image),d=0;d<WIDTH;d++){for(++i%r==0&&console.log(i/r+" %"),t=boundary.times(d-MID_WIDTH).div(WIDTH).add(center_real),e=new Complex_js_1.Complex(t,c),a=new Complex_js_1.Complex(t,c),l=1;l<MAX_N&&a.absolute().lt(2);)(o=a).power2(),a.add(e),a.equals(o)?l=MAX_N:l++;l--,data[t=4*(T*WIDTH+d)]=PALETTE[l][0],data[++t]=PALETTE[l][1],data[++t]=PALETTE[l][2],data[++t]=255}paint(),n=(new Date).getTime()-n,txtRunTime.innerHTML="run time = "+n/1e3+" seconds"}function clickXY(e){var a=e.offsetX,t=e.offsetY;boxReal.value=String(center_real.add(boundary.times(a-MID_WIDTH).div(WIDTH))),boxImage.value=String(center_image.add(boundary.times(t-MID_HEIGHT).div(HEIGHT))),boundary=0==e.button?boundary.div(2):boundary.times(2),boxBoundary.value=boundary.toFixed(50),calculate()}function paint(){ctx.putImageData(imgData,0,0);for(var e=0;e<=WIDTH;e+=100)ctx.moveTo(e,0),ctx.lineTo(e,5),ctx.moveTo(e,HEIGHT),ctx.lineTo(e,HEIGHT-5);for(var a=0;a<=HEIGHT;a+=100)ctx.moveTo(0,a),ctx.lineTo(5,a),ctx.moveTo(WIDTH,a),ctx.lineTo(WIDTH-5,a);ctx.moveTo(MID_WIDTH-5,MID_HEIGHT),ctx.lineTo(MID_WIDTH+5,MID_HEIGHT),ctx.moveTo(MID_WIDTH,MID_HEIGHT-5),ctx.lineTo(MID_WIDTH,MID_HEIGHT+5),ctx.stroke()}paint(),calculate();